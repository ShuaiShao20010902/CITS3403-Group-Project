<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Share Page</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/share.css') }}">
    <script src="{{ url_for('static', filename='js/share.js') }}" defer></script>
</head>
<body>
    {% include 'nav.html' %}
    <div class="container">
        <h1>Sharing Dashboard</h1>

        <!-- Share with someone -->
        <div class="share-form">
            <label for="book-dropdown">Select a Book to Share:</label>
            <select id="book-dropdown">
                <option value="" disabled selected>Select a book</option>
                {% for book in user_books %}
                    <option 
                        value="{{ book.book_id }}" 
                        data-cover="https://covers.openlibrary.org/b/id/{{ book.book.cover_id }}-L.jpg" 
                        data-note="{{ book.notes }}" 
                        data-rating="{{ book.rating }}">
                        {{ book.book.title }}
                    </option>
                {% endfor %}
            </select>

            <div id="book-details" class="card" style="display: none;">
                <img id="book-cover" src="" alt="Book Cover" class="book-cover">
                <p><strong>Note:</strong> <span id="book-note"></span></p>
                <p><strong>Rating:</strong> <span id="book-rating"></span></p>
            </div>

            <input type="text" id="share-username" placeholder="Enter username to share with">
            <button id="share-button">Share</button>
            <p id="share-message"></p>
        </div>

        <div class="section">
            <h2>You're Sharing</h2>
            <div class="shared-cards">
                {% for item in your_shared_items %}
                    <div class="card">
                        {% if item.cover_url %}
                            <img src="{{ item.cover_url }}" alt="Book Cover" class="book-cover">
                        {% endif %}
                        <p><strong>Type:</strong> {{ item.content_type }}</p>
                        <p>{{ item.content_data }}</p>
                        <p class="timestamp">Shared on {{ item.created_at }}</p>
                    </div>
                {% endfor %}
            </div>
        </div>

        <div class="section">
            <h2>Shared with You</h2>
            <div class="shared-cards">
                {% for item in shared_to_user %}
                    <div class="card">
                        {% if item.cover_url %}
                            <img src="{{ item.cover_url }}" alt="Book Cover" class="book-cover">
                        {% endif %}
                        <p><strong>From:</strong> {{ item.shared_by }}</p>
                        <p><strong>Type:</strong> {{ item.content_type }}</p>
                        <p>{{ item.content_data }}</p>
                        <p class="timestamp">Shared on {{ item.created_at }}</p>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
</body>
</html>
